raw = [
      0     1   0 0 1 0 1
      0     2   0 0 1 0 1
  20000     0   0 1 1 0 1
  20000     1   0 1 0 1 1
  30000     0   1 1 0 1 1
  30000     1   1 1 1 0 1
  80000     0   1 0 1 0 1
  80000     1   1 0 1 1 0
 100000     0   1 1 1 1 0
 100000     1   1 1 1 0 1
 110000     0   0 1 1 0 1
 110000     1   0 1 0 1 1
 130000     0   1 1 0 1 1
 130000     1   1 1 1 0 1
 140000     0   1 0 1 0 1
 140000     1   1 0 1 1 0
 200000     0   1 1 1 1 0
 200000     1   1 1 1 0 1
 210000     0   0 1 1 0 1
 210000     1   0 1 0 1 1
 240000     0   0 0 0 1 1
 240000     1   0 0 1 0 1
 260000     0   0 1 1 0 1
 260000     1   0 1 0 1 1
 290000     0   1 1 0 1 1
 290000     1   1 1 1 0 1
 320000     0   1 0 1 0 1
 320000     1   1 0 1 1 0
 330000     0   0 0 1 1 0
 330000     1   0 0 1 0 1
 360000     0   0 1 1 0 1
 360000     1   0 1 0 1 1
 390000     0   1 1 0 1 1
 390000     1   1 1 1 0 1
 430000     0   0 1 1 0 1
 430000     1   0 1 0 1 1
 440000     0   0 0 0 1 1
 440000     1   0 0 1 0 1
 450000     0   1 0 1 0 1
 450000     1   1 0 1 1 0
 460000     0   1 1 1 1 0
 460000     1   1 1 1 0 1
 480000     0   1 0 1 0 1
 480000     1   1 0 1 1 0
 490000     0   0 0 1 1 0
 490000     1   0 0 1 0 1
 530000     0   1 0 1 0 1
 530000     1   1 0 1 1 0
 550000     0   0 0 1 1 0
 550000     1   0 0 1 0 1
 560000     0   0 1 1 0 1
 560000     1   0 1 0 1 1
 570000     0   1 1 0 1 1
 570000     1   1 1 1 0 1
 580000     0   1 0 1 0 1
 580000     1   1 0 1 1 0
 590000     0   0 0 1 1 0
 590000     1   0 0 1 0 1
 630000     0   1 0 1 0 1
 630000     1   1 0 1 1 0
 640000     0   1 1 1 1 0
 640000     1   1 1 1 0 1
 680000     0   1 0 1 0 1
 680000     1   1 0 1 1 0
 690000     0   0 0 1 1 0
 690000     1   0 0 1 0 1
 700000     0   0 1 1 0 1
 700000     1   0 1 0 1 1
 710000     0   1 1 0 1 1
 710000     1   1 1 1 0 1
 730000     0   0 1 1 0 1
 730000     1   0 1 0 1 1
 740000     0   0 0 0 1 1
 740000     1   0 0 1 0 1
 750000     0   1 0 1 0 1
 750000     1   1 0 1 1 0
 760000     0   1 1 1 1 0
 760000     1   1 1 1 0 1
 770000     0   0 1 1 0 1
 770000     1   0 1 0 1 1
 790000     0   1 1 0 1 1
 790000     1   1 1 1 0 1
 800000     0   1 0 1 0 1
 800000     1   1 0 1 1 0
 820000     0   1 1 1 1 0
 820000     1   1 1 1 0 1
 840000     0   1 0 1 0 1
 840000     1   1 0 1 1 0
 860000     0   1 1 1 1 0
 860000     1   1 1 1 0 1
 870000     0   0 1 1 0 1
 870000     1   0 1 0 1 1
 880000     0   0 0 0 1 1
 880000     1   0 0 1 0 1
 910000     0   1 0 1 0 1
 910000     1   1 0 1 1 0
 920000     0   1 1 1 1 0
 920000     1   1 1 1 0 1
 930000     0   0 1 1 0 1
 930000     1   0 1 0 1 1
 940000     0   0 0 0 1 1
 940000     1   0 0 1 0 1
 950000     0   1 0 1 0 1
 950000     1   1 0 1 1 0
 960000     0   1 1 1 1 0
 960000     1   1 1 1 0 1
1000000     0   1 0 1 0 1
1000000     1   1 0 1 1 0
];

ps = raw(:,1);     
A  = raw(:,3);
B  = raw(:,4);

L1 = A | ~B;
L2 = xor(A, B);
L3 = ~A | B;

ts = ps * 1e-12;
dt = max(diff(ts));
t  = [ts; ts(end) + dt];
figure('Color','w','Name','Expected L1 L2 L3 (seconds)');
sgtitle('Compare');

subplot(3,1,1);
stairs(t, [L1; L1(end)], 'k','LineWidth',1.6);
ylim([-0.2 1.2]); ylabel('L1'); grid on; set(gca,'XTickLabel',[]);
xlim([min(ts) 1e-6]);  
subplot(3,1,2);
stairs(t, [L2; L2(end)], 'k','LineWidth',1.6);
ylim([-0.2 1.2]); ylabel('L2'); grid on; set(gca,'XTickLabel',[]);
xlim([min(ts) 1e-6]);

subplot(3,1,3);
stairs(t, [L3; L3(end)], 'k','LineWidth',1.6);
ylim([-0.2 1.2]); ylabel('L3'); grid on; xlabel('Time (s)');
xlim([min(ts) 1e-6]);
